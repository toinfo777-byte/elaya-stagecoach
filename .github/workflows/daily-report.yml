name: Daily status report

on:
  workflow_dispatch:
  schedule:
    - cron: "0 6 * * *"     # 09:00 MSK
    - cron: "30 18 * * *"   # 21:30 MSK

jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - name: Send daily report to Telegram
        env:
          TG_BOT_TOKEN:      ${{ secrets.TG_BOT_TOKEN }}
          TG_STATUS_CHAT_ID: ${{ secrets.TG_STATUS_CHAT_ID }}
        run: |
          set -e
          MSG="âœ… Status report\nrepo: $GITHUB_REPOSITORY\nrun: $GITHUB_RUN_NUMBER"
          curl -fsS -X POST "https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage" \
            -d "chat_id=${TG_STATUS_CHAT_ID}" \
            -d "text=${MSG}" \
            -d "disable_web_page_preview=true" \
            -d "disable_notification=true" \
            -d "parse_mode=HTML" \
            -d 'reply_markup={"remove_keyboard":true}'
