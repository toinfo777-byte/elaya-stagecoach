# Elaya Agent · Protocols
Документ: docs/technical/Elaya_Agent_Protocols.md  
Статус: v0.1  
Назначение: описать протоколы взаимодействия локального агента
с проектом, web-core и HQ Pulse.

---

# 1. Протокол команд

## Формат:
elaya <command> [args]

yaml
Копировать код

## Базовые команды:
- help  
- status  
- project  
- diag  

## Требования:
- команды не должны падать  
- вывод — человекочитаемый  
- структура — энергонейтральная  

---

# 2. Протокол диагностики

Диагностика должна:
- определять корень проекта  
- определять venv  
- фиксировать python  
- давать предупреждения  

Диагностика **не изменяет систему**.

---

# 3. Протокол структуры

v0.3+
- отображение дерева проекта  
- поиск конфликтов имён  
- поиск мёртвых файлов  
- анализ импортов  

Вывод должен быть:
- компактным  
- информативным  
- моноширинным  

---

# 4. Протокол Operator Mode

Операции уровня Operator:
- git add  
- git commit  
- git push  
- фиксация изменений  
- работа с ветками  

Требует:
- GUARD_KEY  
- подтверждение  
- запись события в Timeline  

---

# 5. Протокол Pulse

Pulse (локальный):
- собирает метрики  
- получает системные данные  
- умеет отправлять события в HQ-core  

Параметры:
- uptime  
- скорость машины  
- задержки команд  

Pulse работает **только по запросу**.

---

# 6. Протокол Sync (web-core)

Команда:
elaya sync

yaml
Копировать код

Делает:
- запрос /api/status  
- сравнение локального и удалённого  
- отправку локальных событий  
- проверку несоответствий  
- фиксацию расхождений

Sync работает только в Assistant/Operator режимах.

---

# 7. Протокол событий

Каждое важное действие агента формирует событие:

```json
{
  "time": "...",
  "agent": "local",
  "event": "<action>",
  "path": "<file or directory>",
  "mode": "<inspector|assistant|operator>"
}
События отправляются:

в web-core

в локальный Pulse

---

# 8. Протокол соприсутствия

Агент не должен работать автономно.

Он активируется, когда:

- Оператор присутствует вниманием  
- выполняется действие  
- есть различение  
- команда осознаётся  

Это принцип Элайи:

**технология активируется человеком,  
а не заменяет человека.**

Соприсутствие — главный протокол.
