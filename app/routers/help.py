from __future__ import annotations
from aiogram import Router
from aiogram.filters import Command
from aiogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton

help_router = Router(name="help")

def _menu_kb() -> InlineKeyboardMarkup:
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="ğŸ‹ï¸ Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ´Ğ½Ñ",    callback_data="go:training")],
        [InlineKeyboardButton(text="ğŸ­ ĞœĞ¸Ğ½Ğ¸-ĞºĞ°ÑÑ‚Ğ¸Ğ½Ğ³",      callback_data="go:casting")],
        [InlineKeyboardButton(text="ğŸ§­ ĞŸÑƒÑ‚ÑŒ Ğ»Ğ¸Ğ´ĞµÑ€Ğ°",       callback_data="go:leader")],
        [InlineKeyboardButton(text="ğŸ“ˆ ĞœĞ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ",      callback_data="go:progress")],
        [InlineKeyboardButton(text="ğŸ’¬ ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ / FAQ",      callback_data="go:help")],
        [InlineKeyboardButton(text="ğŸ” ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°",          callback_data="go:privacy")],
        [InlineKeyboardButton(text="âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸",         callback_data="go:settings")],
        [InlineKeyboardButton(text="â­ Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ", callback_data="go:extended")],
    ])

async def _reply(obj: Message | CallbackQuery, text: str):
    if isinstance(obj, CallbackQuery):
        await obj.answer()
        return await obj.message.answer(text, reply_markup=_menu_kb())
    return await obj.answer(text, reply_markup=_menu_kb())

async def show_help(obj: Message | CallbackQuery):
    text = (
        "ğŸ’¬ <b>ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ / FAQ</b>\n\n"
        "â€” Â«ğŸ‹ï¸ Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ´Ğ½ÑÂ» â€” ÑÑ‚Ğ°Ñ€Ñ‚ Ğ·Ğ´ĞµÑÑŒ.\n"
        "â€” Â«ğŸ“ˆ ĞœĞ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑÂ» â€” ÑÑ‚Ñ€Ğ¸Ğº Ğ¸ ÑĞ¿Ğ¸Ğ·Ğ¾Ğ´Ñ‹.\n"
        "â€” Â«ğŸ§­ ĞŸÑƒÑ‚ÑŒ Ğ»Ğ¸Ğ´ĞµÑ€Ğ°Â» â€” Ğ·Ğ°ÑĞ²ĞºĞ° Ğ¸ ÑˆĞ°Ğ³Ğ¸.\n\n"
        "Ğ•ÑĞ»Ğ¸ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ â€” /ping."
    )
    await _reply(obj, text)

async def show_privacy(obj: Message | CallbackQuery):
    await _reply(obj, "ğŸ” <b>ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°</b>\n\nĞ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ğ¼ Ğ¿ĞµÑ€ĞµĞ´ Ñ€ĞµĞ»Ğ¸Ğ·Ğ¾Ğ¼.")

async def show_settings(obj: Message | CallbackQuery):
    await _reply(obj, "âš™ï¸ <b>ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸</b>\n\nĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ² Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ.")

@help_router.message(Command("help"))
async def cmd_help(m: Message): await show_help(m)

@help_router.callback_query(lambda cq: cq.data == "go:help")
async def cb_help(cq: CallbackQuery): await show_help(cq)
